#!/bin/bash

# Function to extract values from JSON
get_value() {
    grep -o "\"$2\":.*" "$1" | grep -o "$3"
}

# Path to your JSON file
json_file="path/to/your/json/file.json"

# Extracting the values for each severity level
critical_total=$(get_value "$json_file" "label" "\"Critical\".*\"total\": [0-9]*" | grep -o "[0-9]*")
high_total=$(get_value "$json_file" "label" "\"High\".*\"total\": [0-9]*" | grep -o "[0-9]*")
medium_total=$(get_value "$json_file" "label" "\"Medium\".*\"total\": [0-9]*" | grep -o "[0-9]*")
low_total=$(get_value "$json_file" "label" "\"Low\".*\"total\": [0-9]*" | grep -o "[0-9]*")
negligible_total=$(get_value "$json_file" "label" "\"Negligible\".*\"total\": [0-9]*" | grep -o "[0-9]*")

# Output the results
echo "Label Critical: $critical_total"
echo "Label High: $high_total"
echo "Label Medium: $medium_total"
echo "Label Low: $low_total"
echo "Label Negligible: $negligible_total"



# Print the extracted values
echo "Result: $result"
echo "Scan URL: $scan_url"
echo "Vulnerabilities: Critical=$critical_count; High=$high_count; Medium=$medium_count; Low=$low_count"

slack_message=$(cat <<EOF
{
  "channel": "$YOUR_CHANNEL_ID",
  "text": "Sysdig Result: \"$result\"\nVulnerabilities: Critical=$critical_count; High=$high_count; Medium=$medium_count; Low=$low_count\nSysdigURL: \"$scan_url\""
}
EOF
)

