---
- name: Resize LV and FS
  hosts: your_target_host  # Replace with your actual target host or group
  become: yes  # This ensures Ansible executes commands with superuser privileges

  tasks:
    - name: List block devices
      command: lsblk
      register: lsblk_output

    - name: Display physical volumes
      command: pvs
      register: pvs_output

    - name: Resize the physical volume
      command: pvresize /dev/nvme0n1p2
      register: pvresize_output

    - name: Resize the partition
      command: growpart /dev/nvme0n1p2
      register: growpart_output

    - name: Resize logical volume and filesystem
      command: lvresize --resizefs -L +10G /dev/mapper/vgroot-lvapps
      register: lvresize_output

    - name: Display filesystem usage
      command: df -h
      register: df_output

    - name: Print lsblk output
      debug:
        var: lsblk_output.stdout_lines

    - name: Print pvs output
      debug:
        var: pvs_output.stdout_lines

    - name: Print pvresize output
      debug:
        var: pvresize_output.stdout_lines

    - name: Print growpart output
      debug:
        var: growpart_output.stdout_lines

    - name: Print lvresize output
      debug:
        var: lvresize_output.stdout_lines

    - name: Print df output
      debug:
        var: df_output.stdout_lines
