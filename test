---
- name: Configure Jenkins Slave
  hosts: your_target_host
  become: yes  # Use if you need root privileges

  tasks:
    - name: Create Jenkins Directory
      file:
        path: /apps/opt/jenkins
        state: directory
        recurse: yes

    - name: Change Directory to Jenkins
      command: cd /apps/opt/jenkins
      args:
        chdir: /apps/opt/jenkins

    - name: Download Jenkins Slave JAR
      ansible.builtin.get_url:
        url: https://jenkins_url/slave.jar
        dest: /apps/opt/jenkins/slave.jar

  - name: Set permissions for slave.jar
      file:
        path: /apps/opt/jenkins/slave.jar
        mode: "u+x"
      register: chmod_result

    # The rest of your tasks...

    - name: Check Jenkins Slave Service Status
      systemd:
        name: jenkinslave
      register: jenkinslave_status

    - name: Start the jenkinsslave service
      systemd:
        name: jenkinsslave
        state: started
      register: start_result

    - name: Enable the jenkinsslave service to start on boot
      systemd:
        name: jenkinsslave
        enabled: yes
      register: enable_result

    - name: Check the status of the jenkinsslave service
      systemd:
        name: jenkinsslave
      register: status_result

    - name: Print service start result
      debug:
        var: start_result

    - name: Print service enable result
      debug:
        var: enable_result

    - name: Print service status result
      debug:
        var: status_result


    - name: Display Jenkins Slave Service Status
      debug:
        var: jenkinslave_status.stdout_lines
