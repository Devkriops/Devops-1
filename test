---
- name: Configure Jenkins Slave
  hosts: your_target_host
  become: yes  # Use if you need root privileges

  tasks:
    - name: Create Jenkins Directory
      file:
        path: /apps/opt/jenkins
        state: directory
        recurse: yes

    - name: Change Directory to Jenkins
      command: cd /apps/opt/jenkins
      args:
        chdir: /apps/opt/jenkins

    - name: Download Jenkins Slave JAR
      command: wget https://jenkins_url/slave.jar
      args:
        creates: /apps/opt/jenkins/slave.jar

    - name: List Files
      command: ls
      args:
        chdir: /apps/opt/jenkins

    - name: Copy systemd Service File
      copy:
        src: path/to/your/systemd/service/file.service
        dest: /etc/systemd/system/
        mode: '0644'

    - name: Copy Files to /apps/opt/jenkins/
      copy:
        src: path/to/your/source/files
        dest: /apps/opt/jenkins/
        mode: '0755'

    - name: Make slave.jar Executable
      command: chmod u+x /apps/opt/jenkins/slave.jar

    - name: Enable Jenkins Slave Service
      systemd:
        name: jenkinslave
        enabled: yes

    - name: Start Jenkins Slave Service
      systemd:
        name: jenkinslave
        state: started

    - name: Check Jenkins Slave Service Status
      systemd:
        name: jenkinslave
      register: jenkinslave_status

    - name: Display Jenkins Slave Service Status
      debug:
        var: jenkinslave_status.stdout_lines
