---
- name: Configure Jenkins Slave
  hosts: your_target_host
  become: yes  # Use if you need root privileges

  tasks:
    - name: Create Jenkins Directory
      file:
        path: /apps/opt/jenkins
        state: directory
        recurse: yes

    - name: Change Directory to Jenkins
      command: cd /apps/opt/jenkins
      args:
        chdir: /apps/opt/jenkins

    - name: Download Jenkins Slave JAR
      ansible.builtin.get_url:
        url: https://jenkins_url/slave.jar
        dest: /apps/opt/jenkins/slave.jar
        force: yes  # Use this option to overwrite the file if it already exists
      register: download_result
      changed_when: download_result.changed  # Mark the task as changed only if a download occurred

    # The rest of your tasks...

    - name: Check Jenkins Slave Service Status
      systemd:
        name: jenkinslave
      register: jenkinslave_status

    - name: Display Jenkins Slave Service Status
      debug:
        var: jenkinslave_status.stdout_lines
